<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- /home/espenr/tmp/qt-3-espenr-26122/qt-embedded-free-3.3.3/src/iconview/qiconview.cpp:2237 -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>iconview/simple_dd/main.cpp Example File</title>
<style type="text/css"><!--
fn { margin-left: 1cm; text-indent: -1cm; }
a:link { color: #004faf; text-decoration: none }
a:visited { color: #672967; text-decoration: none }
body { background: #ffffff; color: black; }
--></style>
</head>
<body>

<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr bgcolor="#E5E5E5">
<td valign=center>
 <a href="index.html">
<font color="#004faf">Home</font></a>
 | <a href="classes.html">
<font color="#004faf">All&nbsp;Classes</font></a>
 | <a href="mainclasses.html">
<font color="#004faf">Main&nbsp;Classes</font></a>
 | <a href="annotated.html">
<font color="#004faf">Annotated</font></a>
 | <a href="groups.html">
<font color="#004faf">Grouped&nbsp;Classes</font></a>
 | <a href="functions.html">
<font color="#004faf">Functions</font></a>
</td>
<td align="right" valign="center"><img src="logo32.png" align="right" width="64" height="32" border="0"></td></tr></table><h1 align=center>iconview/simple_dd/main.cpp Example File</h1>

 
<pre>/****************************************************************************
** $Id: qt/main.cpp   3.3.3   edited May 27 2003 $
**
** Copyright (C) 1992-2001 Trolltech AS.  All rights reserved.
**
** This file is part of an example program for Qt.  This example
** program may be used, distributed and modified without limitation.
**
*****************************************************************************/

#include "main.h"

const char* red_icon[]={
"16 16 2 1",
"r c red",
". c None",
"................",
"................",
"..rrrrrrrrrrrr..",
"..rrrrrrrrrrrr..",
"..rrrrrrrrrrrr..",
"..rrr......rrr..",
"..rrr......rrr..",
"..rrr......rrr..",
"..rrr......rrr..",
"..rrr......rrr..",
"..rrr......rrr..",
"..rrrrrrrrrrrr..",
"..rrrrrrrrrrrr..",
"..rrrrrrrrrrrr..",
"................",
"................"};

const char* blue_icon[]={
"16 16 2 1",
"b c blue",
". c None",
"................",
"................",
"..bbbbbbbbbbbb..",
"..bbbbbbbbbbbb..",
"..bbbbbbbbbbbb..",
"..bbb......bbb..",
"..bbb......bbb..",
"..bbb......bbb..",
"..bbb......bbb..",
"..bbb......bbb..",
"..bbb......bbb..",
"..bbbbbbbbbbbb..",
"..bbbbbbbbbbbb..",
"..bbbbbbbbbbbb..",
"................",
"................"};

const char* green_icon[]={
"16 16 2 1",
"g c green",
". c None",
"................",
"................",
"..gggggggggggg..",
"..gggggggggggg..",
"..gggggggggggg..",
"..ggg......ggg..",
"..ggg......ggg..",
"..ggg......ggg..",
"..ggg......ggg..",
"..ggg......ggg..",
"..ggg......ggg..",
"..gggggggggggg..",
"..gggggggggggg..",
"..gggggggggggg..",
"................",
"................"};


// ListBox -- low level drag and drop

<a name="f2"></a>DDListBox::DDListBox( <a href="qwidget.html">QWidget</a> * parent, const char * name, WFlags f ) :
    <a href="qlistbox.html">QListBox</a>( parent, name, f )
{
    <a href="qwidget.html#setAcceptDrops">setAcceptDrops</a>( TRUE );
    dragging = FALSE;
}


<a name="x2778"></a>void DDListBox::<a href="qwidget.html#dragEnterEvent">dragEnterEvent</a>( <a href="qdragenterevent.html">QDragEnterEvent</a> *evt )
{
<a name="x2776"></a>    if ( QTextDrag::<a href="qtextdrag.html#canDecode">canDecode</a>( evt ) )
<a name="x2768"></a>        evt-&gt;<a href="qdragmoveevent.html#accept">accept</a>();
}


<a name="x2779"></a>void DDListBox::<a href="qwidget.html#dropEvent">dropEvent</a>( <a href="qdropevent.html">QDropEvent</a> *evt )
{
    <a href="qstring.html">QString</a> text;

<a name="x2777"></a>    if ( QTextDrag::<a href="qtextdrag.html#decode">decode</a>( evt, text ) )
        <a href="qlistbox.html#insertItem">insertItem</a>( text );
}


<a name="x2781"></a>void DDListBox::<a href="qwidget.html#mousePressEvent">mousePressEvent</a>( <a href="qmouseevent.html">QMouseEvent</a> *evt )
{
    QListBox::<a href="qwidget.html#mousePressEvent">mousePressEvent</a>( evt );
    dragging = TRUE;
}


<a name="x2780"></a>void DDListBox::<a href="qwidget.html#mouseMoveEvent">mouseMoveEvent</a>( <a href="qmouseevent.html">QMouseEvent</a> * )
{
    if ( dragging ) {
        <a href="qdragobject.html">QDragObject</a> *d = new <a href="qtextdrag.html">QTextDrag</a>( currentText(), this );
<a name="x2767"></a>        d-&gt;<a href="qdragobject.html#dragCopy">dragCopy</a>(); // do NOT delete d.
        dragging = FALSE;
    }
}


// IconViewIcon -- high level drag and drop


<a name="x2771"></a>bool DDIconViewItem::<a href="qiconviewitem.html#acceptDrop">acceptDrop</a>( const <a href="qmimesource.html">QMimeSource</a> *mime ) const
{
<a name="x2774"></a>    if ( mime-&gt;<a href="qmimesource.html#provides">provides</a>( "text/plain" ) )
        return TRUE;
    return FALSE;
}


<a name="x2772"></a>void DDIconViewItem::<a href="qiconviewitem.html#dropped">dropped</a>( <a href="qdropevent.html">QDropEvent</a> *evt, const <a href="qvaluelist.html">QValueList</a>&lt;QIconDragItem&gt;&amp; )
{
    <a href="qstring.html">QString</a> label;

    if ( QTextDrag::<a href="qtextdrag.html#decode">decode</a>( evt, label ) )
        setText( label );
}


// IconView -- high level drag and drop

<a name="x2769"></a>QDragObject *DDIconView::<a href="qiconview.html#dragObject">dragObject</a>()
{
  return new <a href="qtextdrag.html">QTextDrag</a>( <a href="qiconview.html#currentItem">currentItem</a>()-&gt;text(), this );
}

void <a name="f1"></a>DDIconView::slotNewItem( <a href="qdropevent.html">QDropEvent</a> *evt, const <a href="qvaluelist.html">QValueList</a>&lt;QIconDragItem&gt;&amp; )
{
    <a href="qstring.html">QString</a> label;

    if ( QTextDrag::<a href="qtextdrag.html#decode">decode</a>( evt, label ) ) {
        DDIconViewItem *item = new DDIconViewItem( this, label );
<a name="x2773"></a>        item-&gt;<a href="qiconviewitem.html#setRenameEnabled">setRenameEnabled</a>( TRUE );
    }
}



int main( int argc, char *argv[] )
{
    <a href="qapplication.html">QApplication</a> app( argc, argv );

    // Create and show the widgets
    <a href="qsplitter.html">QSplitter</a> *split = new <a href="qsplitter.html">QSplitter</a>();
    DDIconView *iv   = new DDIconView( split );
    (void)             new DDListBox( split );
    app.<a href="qapplication.html#setMainWidget">setMainWidget</a>( split );
    split-&gt;<a href="qwidget.html#resize">resize</a>( 600, 400 );
    split-&gt;<a href="qwidget.html#show">show</a>();

    // Set up the connection so that we can drop items into the icon view
    QObject::<a href="qobject.html#connect">connect</a>(
<a name="x2770"></a>        iv, SIGNAL(<a href="qiconview.html#dropped">dropped</a>(QDropEvent*, const <a href="qvaluelist.html">QValueList</a>&lt;QIconDragItem&gt;&amp;)),
        iv, SLOT(slotNewItem(QDropEvent*, const <a href="qvaluelist.html">QValueList</a>&lt;QIconDragItem&gt;&amp;)));

    // Populate the QIconView with icons
    DDIconViewItem *item;
    item = new DDIconViewItem( iv, "Red",   QPixmap( red_icon ) );
    item-&gt;<a href="qiconviewitem.html#setRenameEnabled">setRenameEnabled</a>( TRUE );
    item = new DDIconViewItem( iv, "Green", QPixmap( green_icon ) );
    item-&gt;<a href="qiconviewitem.html#setRenameEnabled">setRenameEnabled</a>( TRUE );
    item = new DDIconViewItem( iv, "Blue",  QPixmap( blue_icon ) );
    item-&gt;<a href="qiconviewitem.html#setRenameEnabled">setRenameEnabled</a>( TRUE );

    return app.<a href="qapplication.html#exec">exec</a>();
}


</pre><!-- eof -->
<p><address><hr><div align=center>
<table width=100% cellspacing=0 border=0><tr>
<td>Copyright &copy; 2004
<a href="troll.html">Trolltech</a><td align=center><a href="trademarks.html">Trademarks</a>
<td align=right><div align=right>Qt 3.3.3</div>
</table></div></address></body>
</html>
